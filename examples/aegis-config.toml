# Example AegisAudit Configuration
# Save as aegis-config.toml and use with: aegis scan --config aegis-config.toml

# Target URLs to scan
# Can also be specified via --url flag
# urls = ["https://example.com", "https://api.example.com"]

# Allowlist: URLs that are exempt from certain checks
# Useful for known exceptions or legacy systems
allowlist_urls = [
    # "internal-legacy.example.com"
]

# Enable probing for sensitive files (.env, .git, etc.)
# Warning: This actively probes the server
probe_files = false

# Webhook URL for notifications (Slack or Discord)
# webhook = "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# Policy configuration
[policy]

# Required headers configuration
[policy.required_headers]

# HSTS (Strict-Transport-Security)
[policy.required_headers.strict-transport-security]
required = true
min_max_age = 15552000  # 6 months in seconds

# Content Security Policy
[policy.required_headers.content-security-policy]
required = true
# Warn about unsafe directives
warn_unsafe_inline = true
warn_unsafe_eval = true

# X-Frame-Options
[policy.required_headers.x-frame-options]
required = true
allowed_values = ["DENY", "SAMEORIGIN"]

# Referrer-Policy
[policy.required_headers.referrer-policy]
required = true
recommended_values = [
    "strict-origin-when-cross-origin",
    "no-referrer",
    "strict-origin"
]

# X-Content-Type-Options
[policy.required_headers.x-content-type-options]
required = true
expected_value = "nosniff"

# Permissions-Policy (formerly Feature-Policy)
[policy.required_headers.permissions-policy]
required = false  # Optional for now

# Cross-Origin-Opener-Policy (COOP)
[policy.required_headers.cross-origin-opener-policy]
required = false
severity_if_missing = "LOW"

# Cross-Origin-Embedder-Policy (COEP)
[policy.required_headers.cross-origin-embedder-policy]
required = false
severity_if_missing = "LOW"

# Cross-Origin-Resource-Policy (CORP)
[policy.required_headers.cross-origin-resource-policy]
required = false
severity_if_missing = "LOW"

# Headers to flag as information disclosure
banned_headers = [
    "server",
    "x-powered-by",
    "x-aspnet-version",
    "x-aspnetmvc-version",
]

# Cookie security requirements
[policy.cookies]
require_secure_on_https = true
require_httponly = true
require_samesite = true
allowed_samesite_values = ["Strict", "Lax"]

# TLS/SSL requirements
[policy.tls]
min_tls_version = "1.2"
warn_on_expiring_cert_days = 30  # Warn if cert expires in < 30 days

# SAST scanning configuration
[sast]
# Scan depth (how deep to recurse into directories)
max_depth = 10

# Directories to exclude from scanning
exclude_dirs = [
    ".git",
    ".venv",
    "venv",
    "node_modules",
    "__pycache__",
    ".pytest_cache",
    "dist",
    "build",
]

# File patterns to exclude
exclude_files = [
    "*.min.js",
    "*.min.css",
    "*.map",
]

# Secrets detection
[sast.secrets]
# Scan for these types of secrets
scan_for = [
    "aws_access_key",
    "aws_secret_key",
    "google_api_key",
    "private_keys",
    "generic_secrets",
]

# Entropy threshold for generic secret detection (0-8)
entropy_threshold = 4.5

# Static analysis for Python
[sast.python]
check_eval = true
check_exec = true
check_bare_except = true
check_assert_used = false  # Less critical

# Dependency scanning
[sast.dependencies]
# Run safety check for Python
check_python = true

# Run npm audit for Node.js
check_node = true

# Severity threshold (fail if issues above this level)
# Options: CRITICAL, HIGH, MEDIUM, LOW, INFO
fail_threshold = "HIGH"

# Reporting
[reporting]
# Default output formats (json, html, sarif, all)
default_formats = ["html", "json"]

# Include remediation guidance in reports
include_remediation = true

# Include external references (OWASP, etc.)
include_references = true

# Scoring
[scoring]
# Weights for severity levels (used in overall score calculation)
weights = { CRITICAL = 10, HIGH = 5, MEDIUM = 2, LOW = 1, INFO = 0 }

# Perfect score (no findings)
perfect_score = 100.0

# Baseline comparison
[baseline]
# Enable baseline comparison
enabled = false

# Only compare with scans from the same URL
strict_url_matching = true

# Include new findings in baseline comparison
report_new_findings = true

# Include resolved findings in baseline comparison
report_resolved_findings = true
